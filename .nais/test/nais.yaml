# Deploy config for the test cluster
apiVersion: nais.io/v1alpha1
kind: Application
metadata:
  name: klass-web
  namespace: dapla-metadata

spec:
  ingresses:
    - https://klass-web.intern.test.ssb.no
  image: "{{ image }}"  # Injected from the GitHub Action

  replicas:
    max: 1
    min: 1
  resources:
    requests:
      cpu: 50m
      memory: 32Mi
      
  spec:
    containers:
      - name: klass-web
        image: "{{ image }}"
        ports:
          - containerPort: 3000
        volumeMounts:
          - name: nginx-cache
            mountPath: /var/cache/nginx
    volumes:
      - name: nginx-cache
        persistentVolumeClaim:
          claimName: nginx-cache-pvc
